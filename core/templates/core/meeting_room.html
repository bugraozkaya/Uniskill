<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Online Session - UniSkill</title>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; }
        #meet { width: 100%; height: 100%; }
    </style>
</head>
<body>

    <div id="meet"></div>

    <script src='https://meet.jit.si/external_api.js'></script>
    
    <script>
        // Alternative server that doesn't require login (instead of official Jitsi)
        const domain = 'meet.guifi.net';
        const options = {
            roomName: '{{ room_name }}', // Room name passed from Python
            width: '100%',
            height: '100%',
            parentNode: document.querySelector('#meet'),
            userInfo: {
                displayName: '{{ user_display_name }}' // Auto-display user's name
            },
            configOverwrite: { 
                startWithAudioMuted: true,
                startWithVideoMuted: false 
            },
            interfaceConfigOverwrite: {
                SHOW_JITSI_WATERMARK: false, // Tries to hide Jitsi logo
                TOOLBAR_BUTTONS: [
                    'microphone', 'camera', 'desktop', 'fullscreen',
                    'fodeviceselection', 'hangup', 'profile', 'chat',
                    'settings', 'raisehand', 'videoquality', 'filmstrip'
                ]
            }
        };
        const api = new JitsiMeetExternalAPI(domain, options);

        // Return to Dashboard when the call ends (Hangup button clicked)
        api.addEventListeners({
            videoConferenceLeft: function () {
                window.location.href = "{% url 'dashboard' %}";
            }
        });
    </script>
</body>
</html>